
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Employer - Post Job</title>
    <style>
      body{font-family:Arial, Helvetica, sans-serif;max-width:900px;margin:28px auto;padding:0 16px}
      form{display:flex;flex-direction:column;gap:8px}
      textarea{height:200px}
      .msg{padding:8px;background:#f0f8ff;border-radius:6px}
    </style>
  </head>
  <body>
    <h1>Post a Job</h1>
    <form id="jobForm">
      <input name="title" placeholder="Job title" required />
      <textarea name="description" placeholder="Full job description" required></textarea>
      <button type="submit">Create Job</button>
    </form>
    <div id="result"></div>

    <h2>Existing Jobs (file)</h2>
    <pre id="jobsFile" style="background:#f7f7f7;padding:12px;border-radius:6px;max-height:300px;overflow:auto"></pre>

    <script>
      const form = document.getElementById('jobForm');
      const result = document.getElementById('result');
      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        result.textContent = 'Creating job...';
        const data = { title: form.title.value, description: form.description.value };
        try {
          const res = await fetch('/api/jobs', { method: 'POST', headers: { 'Content-Type':'application/json' }, body: JSON.stringify(data) });
          const json = await res.json();
          if (res.ok) {
            result.innerHTML = `<div class="msg">Job created: <strong>${json._id}</strong><br/><a href="/jobs.html">View Jobs / Apply</a></div>`;
            form.reset();
            loadJobsFile();
          } else {
            result.textContent = JSON.stringify(json);
          }
        } catch (err) {
          result.textContent = 'Error: ' + err.message;
        }
      });

      async function loadJobsFile(){
        try {
          const res = await fetch('/api/jobs/file');
          const data = await res.json();
          const el = document.getElementById('jobsFile');
          if (!el) return;
          el.textContent = JSON.stringify(data, null, 2);
        } catch (e) { console.error(e); }
      }

      // initial load
      loadJobsFile();
    </script>
  </body>
</html>
